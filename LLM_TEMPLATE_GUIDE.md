# ðŸ“‹ Professional LLM Output Template Guide

## Overview
This document describes the **structured, professional template** used for LLM-based depression detection explanations in the Streamlit app. The format ensures **clear, consistent, and safe** mental health assessments.

---

## âœ… Template Structure

### **1. High-Level Assessment (NOT a diagnosis)**
- **Purpose**: Provide risk level without making clinical diagnosis
- **Format**: "This message indicates **[low / moderate / high] likelihood of depressive distress** based on emotional and linguistic patterns."
- **Example**: "This message indicates **high likelihood of depressive distress** based on emotional and linguistic patterns."

### **2. Explanation (Why the model thinks this)**
- **Purpose**: Identify key phrases and their emotional/symptom significance
- **Format**: Quote specific phrases and connect them to depression indicators
- **Example**: "Key phrases like 'empty', 'worthless', and 'nothing matters' express hopelessness and emotional numbness. These patterns are commonly associated with sadness, hopelessness, emotional numbness, or loss of interest â€” which are indicators of depressive states."

### **3. Emotion Signals Detected**
- **Purpose**: Classify primary and secondary emotions
- **Format**:
  * Primary emotion: **[sadness / hopelessness / anxiety / exhaustion / joy / neutral]**
  * Secondary emotions: **[list or none]**
- **Example**:
  * Primary emotion: **sadness**
  * Secondary emotions: **hopelessness, anxiety**

### **4. Possible Symptoms Reflected in the Text**
- **Purpose**: List mental health symptoms evident in the text
- **Options**: hopelessness, emptiness, fatigue, loss of motivation, social withdrawal, emotional numbness, loss of meaning, none detected
- **Example**: 
  * **emotional numbness**
  * **loss of motivation**
  * **social withdrawal**

### **5. Reasoning Steps**
- **Purpose**: Explain AI's analysis process transparently
- **Format**: Brief numbered steps (3-5 steps)
- **Example**:
  1. Identifies emotional cues in the text
  2. Connects them with known depressive expressions
  3. Checks tone, intensity, and context
  4. Produces safe and non-diagnostic explanation

### **6. Safety Note**
- **Purpose**: Ethical disclaimer and crisis resources
- **Required Text**: "This explanation is generated by an AI system for educational purposes and is **NOT a medical diagnosis**. If someone is experiencing emotional distress, contacting a mental-health professional or trusted person is strongly recommended."

### **Final Output**
- **PREDICTION**: [Depression or Control]
- **CONFIDENCE**: [0.0 to 1.0]

---

## ðŸŽ¯ Prompt Engineering Techniques

The app supports **5 different prompting strategies** for better LLM performance:

### **1. Zero-Shot**
- **Description**: Direct instruction without examples
- **Best for**: Quick analysis, general assessment
- **Pros**: Fast, straightforward
- **Cons**: May lack nuance for edge cases

### **2. Few-Shot**
- **Description**: Provides 2-3 examples before analysis
- **Best for**: Consistent formatting, pattern recognition
- **Pros**: More accurate, learns from examples
- **Cons**: Longer prompts, more tokens

### **3. Chain-of-Thought**
- **Description**: Asks LLM to think step-by-step
- **Best for**: Complex cases, detailed reasoning
- **Pros**: Transparent reasoning, better explanations
- **Cons**: Slower, more verbose

### **4. Role-Based**
- **Description**: LLM acts as a clinical psychologist
- **Best for**: Professional assessment, clinical language
- **Pros**: Expert perspective, DSM-5 aligned
- **Cons**: May be too technical

### **5. Structured (DSM-5)**
- **Description**: Systematic evaluation using mental health criteria
- **Best for**: Comprehensive analysis, research
- **Pros**: Most thorough, criterion-based
- **Cons**: Longest output, most tokens

---

## ðŸ“Š Example Output

### Input Text:
"I feel so empty and worthless. Nothing brings me joy anymore and I can't see a point in anything."

### Structured Assessment:

**1. High-Level Assessment**
This message indicates **high likelihood of depressive distress** based on emotional and linguistic patterns.

**2. Explanation**
Key phrases like 'empty', 'worthless', and 'nothing brings me joy' express hopelessness, worthlessness, and anhedonia. These patterns are commonly associated with sadness, hopelessness, emotional numbness, or loss of interest â€” which are indicators of depressive states.

**3. Emotion Signals Detected**
â€¢ Primary emotion: **sadness**
â€¢ Secondary emotions: **hopelessness, emptiness**

**4. Possible Symptoms Reflected**
â€¢ **hopelessness**
â€¢ **worthlessness**
â€¢ **emotional numbness**
â€¢ **loss of interest (anhedonia)**

**5. Reasoning Steps**
1. Identifies strong negative emotional language
2. Recognizes core depression symptoms (worthlessness, anhedonia)
3. Assesses high intensity and multiple indicators
4. Produces structured explanation with safety disclaimer

**6. Safety Note**
This explanation is generated by an AI system for educational purposes and is **NOT a medical diagnosis**. If someone is experiencing emotional distress, contacting a mental-health professional or trusted person is strongly recommended.

**PREDICTION:** Depression
**CONFIDENCE:** 0.92

---

## ðŸ”§ Implementation Details

### Code Location
- **Template Functions**: `get_prompt_templates()` in `src/app/app.py`
- **OpenAI Integration**: `predict_with_openai()` (line ~600)
- **Groq Integration**: `predict_with_groq()` (line ~650)
- **Google Integration**: `predict_with_google()` (line ~700)

### Session State Storage
Full explanations are stored in `st.session_state.llm_explanation` dictionary:
```python
st.session_state.llm_explanation = {
    'openai': "full structured explanation...",
    'groq': "full structured explanation...",
    'google': "full structured explanation..."
}
```

### Display Components
- **Analyze Tab**: Shows full explanation in expandable section
- **Compare Tab**: Shows structured results for all models
- **Batch Tab**: Includes explanation column in CSV export

---

## âœ¨ Benefits of This Format

### **1. Consistency**
- All LLM providers use same structure
- Easy to compare results across models
- Standardized for research/evaluation

### **2. Safety**
- Always includes disclaimer
- Emphasizes educational purpose
- Recommends professional help

### **3. Transparency**
- Shows reasoning process
- Explains key evidence
- Lists detected patterns

### **4. Professional**
- Follows mental health assessment standards
- Uses DSM-5 aligned terminology
- Appropriate for research presentations

### **5. User-Friendly**
- Clear risk levels (low/moderate/high)
- Structured sections easy to read
- Actionable insights

---

## ðŸš€ Usage in App

### **Step 1**: Select LLM Provider
- OpenAI (ChatGPT)
- Groq (Llama 3.1)
- Google (Gemini)

### **Step 2**: Enter API Key
- Securely stored in session state
- Not logged or saved

### **Step 3**: Choose Prompt Technique
- Select from 5 strategies in sidebar
- Each optimized for different use cases

### **Step 4**: Analyze Text
- Enter text or use sample buttons
- Click "ðŸš€ Analyze with LLM"
- View structured assessment

### **Step 5**: Review Results
- See prediction and confidence
- Expand full professional assessment
- Export or compare with trained models

---

## ðŸ“š References

### Mental Health Standards
- **DSM-5**: Diagnostic and Statistical Manual of Mental Disorders
- **PHQ-9**: Patient Health Questionnaire (9-item depression scale)
- **ICD-11**: International Classification of Diseases

### Prompt Engineering
- **Chain-of-Thought**: Wei et al. (2022) - "Chain-of-Thought Prompting Elicits Reasoning"
- **Few-Shot Learning**: Brown et al. (2020) - "Language Models are Few-Shot Learners"
- **Role-Based Prompting**: Recent best practices from OpenAI, Anthropic

### Ethical AI
- **Transparency**: Explain AI decision-making
- **Safety**: Always disclaim non-diagnostic nature
- **Responsibility**: Recommend professional help

---

## âš ï¸ Important Disclaimers

### **Educational Purpose Only**
This system is for **research and educational demonstration** purposes. It is **NOT**:
- A medical diagnostic tool
- A replacement for clinical assessment
- Suitable for emergency crisis intervention

### **Professional Help**
If experiencing mental health crisis:
- **988 Suicide & Crisis Lifeline**: Call or text 988 (USA)
- **Crisis Text Line**: Text HOME to 741741
- **Emergency**: Call local emergency services (911 in USA)

### **Data Privacy**
- API calls sent to external services (OpenAI, Groq, Google)
- No data stored long-term in app
- Review provider privacy policies

---

## ðŸ“ Maintenance Notes

### Updating Templates
To modify prompt templates, edit `get_prompt_templates()` in `src/app/app.py`:
```python
def get_prompt_templates() -> Dict[str, Dict[str, str]]:
    return {
        "Zero-Shot": {
            "system": "System instruction...",
            "user": "User prompt template with {text} placeholder..."
        },
        # Add more techniques...
    }
```

### Adding New Techniques
1. Add new key-value pair to dictionary
2. Update `prompt_techniques` list in sidebar (line ~975)
3. Test with sample texts
4. Document in this guide

### Testing
- Test all 5 techniques with diverse inputs
- Check safety disclaimers always present
- Verify confidence parsing works
- Ensure structured format maintained

---

**Last Updated**: November 25, 2025
**Version**: 2.0
**Author**: Depression Detection AI Project Team
